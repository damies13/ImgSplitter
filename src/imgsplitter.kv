#:kivy 1.0
#:import kivy kivy
#:import win kivy.core.window


# MDBoxLayout:
# 	orientation: 'vertical'
# 	Label:
# 		text: 'Python Kivy Tutorial'
# 		font_size: '30pt'
# 	Label:
# 		text: 'From TutorialsPoint'
# 		font_size: '50'
# 		color: (1,0,0,1)

# Main box
<ImgSplitterWindow>:
# 	FloatLayout:
# 		pos:0,0
# 		size: root.width, root.height
	# img_src = 'data/images/transperent.png'

	# canvas:
	# 	Color:
	# 		rgba: root.background_color
	# 	Rectangle:
	# 		pos: self.pos
	# 		size: self.size

	MDBoxLayout:
		padding: 1
		spacing: 3
		orientation: 'vertical'

		# menu bar
		MDBoxLayout:
			orientation: 'horizontal'
			# size_hint: (1, .05)
			size_hint: (1, .6)
			# size_hint: (1, 1)


			MDRaisedButton:
				id: open_file
				text: 'Open File'
				# on_press: root.on_MDRaisedButton_press_open_file(parent=self.parent.parent.parent)
				# on_press: root.on_MDRaisedButton_press_open_file(spliterise)
				on_press: root.show_load()
				valign: "top"

			Label:
				# size_hint: (5, 0.05)
				text: ""

			MDRaisedButton:
				id: spliterise
				text: 'Spliterise'
				on_press: root.on_button_press(spliterise)
				valign: "top"

			# Label:
			# 	size_hint: (3, 0.05)
			# 	text: ""

			# Custom:
			# 	values: ['Dark', 'Light']

		# MDBoxLayout:
		# 	orientation: 'horizontal'
		# 	# size_hint: (1, .05)
		# 	size_hint: (1, .3)
		#
		# 	Label:
		# 		# size_hint: (5, 0.05)
		# 		text: ""


		MDBoxLayout:
			id: imgbox
			orientation: 'horizontal'
			# work area
			size_hint: (1, 9)
			# img_src = 'data/images/transperent.png'
			valign: "top"

			# MDFloatLayout:
				# valign: "top"
			FloatLayout:
				id: img_canvas
				size_hint: (1, 1)
				# anchor_y: 'top'
				# anchor_y: 'center'

				canvas:
					# id: base_canvas
					Color:
						rgb: 1, 1, 1, 0
						# rgb: 1, 1, 1, .5
						# rgb: 0, 0, 0, 0.8
						# anchor_y: 'top'
					Rectangle:
						id: bg
						source: 'data/images/checkerboard.png'
						size: self.size
					Rectangle:
						id: img
						# source: 'data/images/shadow32.png'
						# source: 'data/images/transperent.png'
						source: root.img_src
						size: self.size
						# size: (.8, 88)

			# config tool box
			MDBoxLayout:
				size_hint: (.3, 1)
				# size_hint: (1, None)
				# size_hint: (20, 10)
				# width: .3
				orientation: 'vertical'

				# header row
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: "(pixels)"
						halign: "center"
						valign: 'middle'
						text_size: self.size
				# sub header row
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: "Offset"
						halign: "left"
						valign: 'middle'
						text_size: self.size
				# spacer row
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: ""
				# 	MDLabel:
				# 		text: ""
				# 	MDLabel:
				# 		text: "Top"
				# 	MDLabel:
				# 		text: ""
				# 	MDLabel:
				# 		text: ""
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: ""
					MDTextField:
						id: offset_left
						halign: "center"
						multiline: False
						input_filter: 'int'
						text: str(root.subimg_left)
						hint_text: "Left"
						on_text_validate: root.set_subimg_left(offset_left)
						on_touch_move: root.set_subimg_left(offset_left)
						on_touch_up: root.set_subimg_left(offset_left)
					MDLabel:
						text: ""
					MDTextField:
						id: offset_top
						halign: "center"
						multiline: False
						input_filter: 'int'
						text: str(root.subimg_top)
						hint_text: "Top"
						# mode: "rectangle"
						on_text_validate: root.set_subimg_top(offset_top)
						on_touch_move: root.set_subimg_top(offset_top)
						on_touch_up: root.set_subimg_top(offset_top)
					MDLabel:
						text: ""
				# sub header row
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: "Seperation"
						halign: "left"
						valign: 'middle'
						text_size: self.size
				# spacer row
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: ""
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: ""
					MDTextField:
						id: offset_vert
						halign: "center"
						multiline: False
						input_filter: 'int'
						text: str(root.subimg_vert)
						hint_text: "Verical"
						on_text_validate: root.set_subimg_vert(offset_vert)
						on_touch_move: root.set_subimg_vert(offset_vert)
						on_touch_up: root.set_subimg_vert(offset_vert)
					MDLabel:
						text: ""
					MDTextField:
						id: offset_horz
						halign: "center"
						multiline: False
						input_filter: 'int'
						text: str(root.subimg_horz)
						hint_text: "Horizontal"
						on_text_validate: root.set_subimg_horz(offset_horz)
						on_touch_move: root.set_subimg_horz(offset_horz)
						on_touch_up: root.set_subimg_horz(offset_horz)
					MDLabel:
						text: ""
				# sub header row
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: "Sub Image"
						halign: "left"
						valign: 'middle'
						text_size: self.size
				# spacer row
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: ""
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: ""
					MDTextField:
						id: size_width
						halign: "center"
						multiline: False
						input_filter: 'int'
						text: str(root.subimg_width)
						hint_text: "Width"
						on_text_validate: root.set_subimg_width(size_width)
						on_touch_move: root.set_subimg_width(size_width)
						on_touch_up: root.set_subimg_width(size_width)
					MDLabel:
						text: ""
					MDTextField:
						id: size_height
						halign: "center"
						multiline: False
						input_filter: 'int'
						text: str(root.subimg_height)
						hint_text: "Height"
						on_text_validate: root.set_subimg_height(size_height)
						on_touch_move: root.set_subimg_height(size_height)
						on_touch_up: root.set_subimg_height(size_height)
					MDLabel:
						text: ""
				# sub header row
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: "Grid"
						halign: "left"
						valign: 'middle'
						text_size: self.size
				# spacer row
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: ""
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					Label:
						text: ""
					MDTextField:
						id: count_cols
						halign: "center"
						multiline: False
						input_filter: 'int'
						text: str(root.subimg_cols)
						hint_text: "Columns"
						on_text_validate: root.set_subimg_cols(count_cols)
						on_touch_move: root.set_subimg_cols(count_cols)
						on_touch_up: root.set_subimg_cols(count_cols)
					MDLabel:
						text: ""
					MDTextField:
						id: count_rows
						halign: "center"
						multiline: False
						input_filter: 'int'
						text: str(root.subimg_rows)
						hint_text: "Rows"
						on_text_validate: root.set_subimg_rows(count_rows)
						on_touch_move: root.set_subimg_rows(count_rows)
						on_touch_up: root.set_subimg_rows(count_rows)
					MDLabel:
						text: ""
				# Block space row
				MDBoxLayout:
					size_hint: (1, 5)
					orientation: 'horizontal'
					MDLabel:
						text: ""
				# MDBoxLayout:
				# 	size_hint: (.3, 1)
				# 	orientation: 'vertical'
				# MDBoxLayout:
				# 	size_hint: (1, 1)
				# 	orientation: 'vertical'
				MDBoxLayout:
					size_hint: (1, 0.5)
					orientation: 'horizontal'
					MDLabel:
						text: root.version_display
						halign: "center"

		# MDBoxLayout:
		# 	orientation: 'horizontal'
		# MDBoxLayout:
		# 	orientation: 'horizontal'
		# MDBoxLayout:
		# 	orientation: 'horizontal'
		# MDBoxLayout:
		# 	orientation: 'horizontal'
		# MDBoxLayout:
		# 	orientation: 'horizontal'

		# # status bar
		# MDBoxLayout:
		# 	orientation: 'horizontal'
		# 	# size_hint: (1, .05)
		# 	size_hint: (1, 1)
		# 	valign: "bottom"
		# 	halign: "left"
		#
		# 	MDLabel:
		# 		id: status_bar
		# 		# size_hint: (5, 0.05)
		# 		text: root.status_bar
		# 		valign: "bottom"
		# 		halign: "left"



<Custom@Switch>:
	values: ['OFF', 'ON']
	canvas:
		Color:
			rgb: 0.2, 0.709, 0.898, 1
		Rectangle:
			size: [sp(41.5), sp(20)]
			pos: [self.center_x - sp(41.5), self.center_y - sp(10)]
		Color:
			rgb: 0.4, 0.4, 0.4, 1
		Rectangle:
			size: [sp(41.5), sp(20)]
			pos: [self.center_x, self.center_y - sp(10)]
	MDLabel:
		text: '[b]{}[/b]'.format(root.values[0])
		markup: True
		font_size: 13
		pos: [root.center_x - sp(70), root.center_y - sp(50)]
	MDLabel:
		color: 0.75, 0.75, 0.75, 1
		text: '[b]{}[/b]'.format(root.values[1])
		markup: True
		font_size: 13
		pos: [root.center_x - sp(30), root.center_y - sp(50)]


<LoadDialog>:
	MDBoxLayout:
		size: root.size
		pos: root.pos
		orientation: "vertical"
		FileChooserListView:
		# MDFileManager:
			id: filechooser
			path: "."

		MDBoxLayout:
			size_hint_y: None
			height: 30
			MDRaisedButton:
				id: test
				text: "Cancel"
				on_release: root.cancel()

			MDLabel:
				text: ""

			MDRaisedButton:
				text: "Load"
				on_release: root.load(filechooser.path, filechooser.selection)

<SaveDialog>:
	text_input: text_input
	MDBoxLayout:
		size: root.size
		pos: root.pos
		orientation: "vertical"
		FileChooserListView:
			id: filechooser
			on_selection: text_input.text = self.selection and self.selection[0] or ''

		MDTextField:
			id: text_input
			size_hint_y: None
			height: 30
			multiline: False

		MDBoxLayout:
			size_hint_y: None
			height: 30
			MDRaisedButton:
				text: "Cancel"
				on_release: root.cancel()

			MDRaisedButton:
				text: "Save"
				on_release: root.save(filechooser.path, text_input.text)
